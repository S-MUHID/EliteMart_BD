<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Customer Login - EliteMart BD</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        body.auth-page {
            background: #0b0b0b;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        .auth-page-content {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
        }
        .auth-page header {
            display: none !important;
        }
        .auth-page-body {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }
        
        /* Dragon Wing Effect - Enhanced */
        .dragon-wing {
            position: fixed;
            top: 50%;
            right: -150px;
            width: 500px;
            height: 600px;
            z-index: 5;
            transform: translateY(-50%);
            animation: wingFlutterEnhanced 5s ease-in-out infinite;
            pointer-events: none;
            filter: drop-shadow(0 0 60px rgba(217, 178, 74, 0.9)) drop-shadow(0 0 100px rgba(217, 178, 74, 0.5)) drop-shadow(0 0 150px rgba(217, 178, 74, 0.2));
        }
        
        @keyframes wingFlutterEnhanced {
            0%, 100% { 
                right: -150px; 
                opacity: 0.3;
                filter: drop-shadow(0 0 50px rgba(217, 178, 74, 0.7));
            }
            50% { 
                right: -40px; 
                opacity: 0.5;
                filter: drop-shadow(0 0 80px rgba(217, 178, 74, 1)) drop-shadow(0 0 120px rgba(217, 178, 74, 0.6));
            }
        }
        
        .dragon-wing svg {
            width: 100%;
            height: 100%;
            filter: inherit;
        }
    </style>
</head>
<body class="auth-page">
    <div class="auth-page-content">
        <!-- Header will be inserted here by header.js - HIDDEN -->
        
        <!-- Dragon Wing Effect -->
        <div class="dragon-wing">
            <svg viewBox="0 0 250 500" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="#d9b24a" stroke-width="1.5">
                <!-- Main wing outline -->
                <path d="M 80 80 Q 180 120 220 250 Q 180 320 80 420 Q 70 250 80 80" fill="#d9b24a" opacity="0.25" stroke="#d9b24a" stroke-width="2"/>
                
                <!-- Primary wing veins -->
                <path d="M 90 110 Q 160 150 200 230" stroke="#d9b24a" stroke-width="2" opacity="0.8"/>
                <path d="M 95 140 Q 170 170 210 260" stroke="#d9b24a" stroke-width="1.5" opacity="0.7"/>
                <path d="M 100 170 Q 175 190 215 290" stroke="#d9b24a" stroke-width="1.5" opacity="0.7"/>
                <path d="M 105 200 Q 180 210 220 320" stroke="#d9b24a" stroke-width="1.5" opacity="0.7"/>
                <path d="M 110 230 Q 185 230 225 350" stroke="#d9b24a" stroke-width="2" opacity="0.8"/>
                <path d="M 100 260 Q 180 250 220 380" stroke="#d9b24a" stroke-width="1.5" opacity="0.7"/>
                <path d="M 95 290 Q 175 270 215 410" stroke="#d9b24a" stroke-width="1.5" opacity="0.7"/>
                
                <!-- Secondary detail lines -->
                <path d="M 85 120 L 175 140"/>
                <path d="M 88 160 L 190 180"/>
                <path d="M 92 200 L 200 220"/>
                <path d="M 95 240 L 210 260"/>
                <path d="M 98 280 L 215 300"/>
                <path d="M 92 320 L 210 340"/>
                <path d="M 88 360 L 200 380"/>
                
                <!-- Glow orbs -->
                <circle cx="120" cy="130" r="5" fill=\"#d9b24a\" opacity=\"0.7\"/>\n                <circle cx="150" cy=\"180\" r=\"6\" fill=\"#d9b24a\" opacity=\"0.8\"/>\n                <circle cx=\"180\" cy=\"250\" r=\"7\" fill=\"#d9b24a\" opacity=\"0.9\"/>\n                <circle cx=\"170\" cy=\"320\" r=\"6\" fill=\"#d9b24a\" opacity=\"0.8\"/>\n                <circle cx=\"140\" cy=\"380\" r=\"5\" fill=\"#d9b24a\" opacity=\"0.7\"/>\n                
                <!-- Sparkle effects -->
                <circle cx=\"200\" cy=\"220\" r=\"3\" fill=\"#d9b24a\" opacity=\"0.6\"/>\n                <circle cx=\"210\" cy=\"290\" r=\"2.5\" fill=\"#d9b24a\" opacity=\"0.5\"/>\n                <circle cx=\"190\" cy=\"360\" r=\"2.5\" fill=\"#d9b24a\" opacity=\"0.5\"/>\n            </svg>\n        </div>

        <div class="auth-page-body">
            <div class="glass-card" style="width: 100%; max-width: 420px; padding: 2rem; border-radius: 14px;">
                
                <!-- Header -->
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <h1 style="font-size: 1.8rem; font-weight: 700; color: var(--gold); margin: 0 0 0.5rem 0;">Welcome back</h1>
                    <p style="color: var(--muted); font-size: 0.95rem;">Login to continue shopping</p>
                </div>

                <div id="error" class="auth-error"></div>

                <!-- Login Form -->
                <form style="display: block;">
                    <div class="input-container" id="email-container">
                        <label for="custEmail" class="label">üìß Email or Phone Number</label>
                        <input id="custEmail" type="text" />
                    </div>

                    <div class="input-container has-icon" id="password-container">
                        <label for="custPassword" class="label">üîê Password</label>
                        <input id="custPassword" type="password" />
                        <button type="button" id="togglePassword" class="input-icon-btn" aria-label="Toggle password visibility">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>

                    <div style="text-align: right; margin-top: 0.75rem; margin-bottom: 1.5rem;">
                        <button type="button" id="forgotBtn" style="color: #00ffff; text-decoration: none; font-size: 0.9rem; transition: color 0.3s; background: none; border: none; cursor: pointer; padding: 0;">Forgot Password?</button>
                    </div>

                    <button type="button" class="shimmer-btn" id="loginBtn" style="width: 100%; padding: 0.75rem; margin-top: 1.5rem; border-radius: 10px; font-weight: 600; color: white; border: none; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s;">
                        INITIATE AUTHENTICATION
                    </button>
                </form>

                <div class="link" style="margin-top: 1rem;">Don't have an account? <a href="customer-signup.html" id="showSignup">Create one</a></div>

                <hr class="divider" style="margin: 1rem 0;" />
                <div style="text-align: center; color: #bbb; font-size: 0.9rem; margin-bottom: 0.5rem;">Or continue as guest</div>
                <div class="auth-actions"><button type="button" onclick="continueAsGuest()" class="btn btn-ghost" style="padding: 0.75rem;">Continue as Guest</button></div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer style="background: linear-gradient(135deg, #0f0f0f, #000); border-top: 2px solid #333; padding: 30px 20px; text-align: center; color: var(--muted); margin-top: auto;">
            <div style="max-width: 1200px; margin: 0 auto;">
                <h3 style="color: var(--gold); margin-bottom: 15px;">Need Help?</h3>
                <p style="margin: 10px 0; font-size: 0.95rem;">Contact us at <strong style="color: var(--gold);">support@elitemart.bd</strong> for any assistance with returns, exchanges, or account issues.</p>
                <p style="margin: 10px 0; font-size: 0.9rem; color: #999;">Available: Monday - Saturday, 10 AM - 6 PM (Bangladesh Time)</p>
                <hr style="border: none; border-top: 1px solid #333; margin: 20px 0;" />
                <p style="margin: 5px 0; font-size: 0.85rem;">¬© 2025 EliteMart BD ‚Ä¢ All Rights Reserved</p>
            </div>
        </footer>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center; padding: 20px;">
        <div style="background: linear-gradient(135deg, #0f0f0f, #0a0a0a); border: 2px solid #333; border-radius: 12px; padding: 30px; max-width: 420px; width: 100%;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #333;">
                <h2 style="color: var(--gold); margin: 0; font-size: 1.4rem;">üîê Reset Password</h2>
                <button onclick="closeForgotModal()" style="background: none; border: none; color: var(--gold); font-size: 24px; cursor: pointer; transition: all 0.3s;">‚úï</button>
            </div>
            <p style="color: var(--muted); margin-bottom: 20px;">Enter your email or phone number to receive password reset instructions.</p>
            <div class="input-container" id="forgot-container">
                <label for="forgotIdentifier" class="label">üìß Email or Phone</label>
                <input id="forgotIdentifier" type="text" />
            </div>
            <div id="forgotMessage" style="color: #adffad; background: rgba(11, 61, 11, 0.3); padding: 12px; border-radius: 8px; margin: 15px 0; display: none; text-align: center; border: 1px solid #0b3d0b;"></div>
            <button onclick="sendResetLink()" style="width: 100%; padding: 12px; background: var(--gold); color: #000; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; margin-top: 20px; transition: all 0.3s;">Send Reset Link</button>
            <button onclick="closeForgotModal()" style="width: 100%; padding: 12px; background: #333; color: #fff; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; margin-top: 10px; transition: all 0.3s;">Cancel</button>
        </div>
    </div>

    <script src="header.js"></script>

    <script src="header.js"></script>
    <script>
        // Sliding Label/Focus Effect for Portal Style
        function setupPortalInputs() {
            document.querySelectorAll('.input-container input').forEach(input => {
                const container = input.closest('.input-container');

                // Initial check for 'filled' state on load
                if (input.value.length > 0) {
                    container.classList.add('filled');
                }

                input.addEventListener('focus', () => {
                    container.classList.add('focused');
                    container.classList.remove('filled');
                });

                input.addEventListener('blur', () => {
                    container.classList.remove('focused');
                    if (input.value.length > 0) {
                        container.classList.add('filled');
                    }
                });

                input.addEventListener('input', () => {
                    if (input.value.length > 0) {
                        container.classList.add('filled');
                    } else {
                        container.classList.remove('filled');
                    }
                });
            });
        }

        // Password Toggle for login only
        function setupPasswordToggles() {
            const toggleLoginPassword = document.getElementById('togglePassword');
            if (toggleLoginPassword) {
                toggleLoginPassword.addEventListener('click', (e) => {
                    e.preventDefault();
                    const input = document.getElementById('custPassword');
                    const icon = toggleLoginPassword.querySelector('i');
                    if (input.type === 'password') {
                        input.type = 'text';
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        input.type = 'password';
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                });
            }
        }

        // Original Login Logic (Preserved)
        const loginBtn = document.getElementById('loginBtn');
        const showSignup = document.getElementById('showSignup');
        const errorDiv = document.getElementById('error');

        function showError(msg) {
            errorDiv.textContent = msg;
            errorDiv.style.display = 'block';
            setTimeout(() => errorDiv.style.display = 'none', 3500);
        }

        loginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const identifier = document.getElementById('custEmail').value.trim();
            const pass = document.getElementById('custPassword').value;
            if (!identifier || !pass) { showError('Please enter credentials'); return; }
            const users = JSON.parse(localStorage.getItem('customers') || '[]');
            // allow login by email or phone
            const user = users.find(u => (u.email && u.email === identifier || u.phone && u.phone === identifier) && u.password === pass);
            if (!user) { showError('No account found or wrong password'); return; }
            // mark logged in
            sessionStorage.setItem('customerLoggedIn', 'true');
            sessionStorage.setItem('customerEmail', user.email || '');
            sessionStorage.setItem('customerName', user.name || 'Customer');
            
            // Show success feedback
            const buttonText = loginBtn.textContent;
            loginBtn.textContent = 'ACCESS GRANTED. REDIRECTING...';
            loginBtn.style.background = '#0b3d0b';
            loginBtn.style.color = '#adffad';
            
            setTimeout(() => {
                const next = new URLSearchParams(location.search).get('next') || 'index.html';
                location.href = next;
            }, 1500);
        });

        // Forgot Password functionality
        const forgotBtn = document.getElementById('forgotBtn');
        const forgotModal = document.getElementById('forgotModal');
        const forgotMessage = document.getElementById('forgotMessage');

        forgotBtn.addEventListener('click', (e) => {
            e.preventDefault();
            forgotModal.style.display = 'flex';
            setupPortalInputs(); // Re-setup portal inputs for forgot modal
        });

        function closeForgotModal() {
            forgotModal.style.display = 'none';
            document.getElementById('forgotIdentifier').value = '';
            forgotMessage.style.display = 'none';
        }

        function sendResetLink() {
            const identifier = document.getElementById('forgotIdentifier').value.trim();
            if (!identifier) { 
                forgotMessage.textContent = '‚ö†Ô∏è Please enter your email or phone number';
                forgotMessage.style.background = 'rgba(255, 100, 100, 0.2)';
                forgotMessage.style.color = '#ff6464';
                forgotMessage.style.borderColor = '#992222';
                forgotMessage.style.display = 'block';
                return; 
            }
            const users = JSON.parse(localStorage.getItem('customers') || '[]');
            const user = users.find(u => (u.email && u.email === identifier) || (u.phone && u.phone === identifier));
            if (!user) {
                forgotMessage.textContent = '‚ùå No account found with this email or phone';
                forgotMessage.style.background = 'rgba(255, 100, 100, 0.2)';
                forgotMessage.style.color = '#ff6464';
                forgotMessage.style.borderColor = '#992222';
                forgotMessage.style.display = 'block';
                return;
            }
            // Show success message
            forgotMessage.textContent = '‚úÖ Reset link sent! Check your email/SMS for instructions.';
            forgotMessage.style.background = 'rgba(11, 61, 11, 0.3)';
            forgotMessage.style.color = '#adffad';
            forgotMessage.style.borderColor = '#0b3d0b';
            forgotMessage.style.display = 'block';
            setTimeout(() => closeForgotModal(), 3000);
        }

        // Close modal when clicking outside
        forgotModal.addEventListener('click', (e) => {
            if (e.target === forgotModal) closeForgotModal();
        });

        function continueAsGuest() {
            sessionStorage.setItem('customerLoggedIn', 'false');
            location.href = 'index.html';
        }

        // Initialize portal interactions on page load
        window.addEventListener('DOMContentLoaded', () => {
            setupPortalInputs();
            setupPasswordToggles();
        });
    </script>
</body>
</html>